<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Finance & Accounting - Electronics Distribution</title>
    <link rel="stylesheet" href="styles.css">
    <script src="navbar.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <div id="navbar-placeholder"></div>

    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back to Master Map</a>
        
        <h2>Level 1: Finance (AR & AP)</h2>
        <p>Managing Cash Flow. <b>AR:</b> Collections & Credit. <b>AP:</b> 3-Way Matching & Payments.</p>

        <div class="grid-container">
            <!-- LEFT COLUMN: AR -->
            <div class="diagram-card">
                <h3>Part 1: Accounts Receivable (Inflow)</h3>
                
                <div class="mermaid">
                graph TD
                    %% Define Colors
                    classDef commercial fill:#fff3e0,stroke:#e65100,stroke-width:2px;
                    classDef finance fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px;

                    %% --- ACCOUNTS RECEIVABLE ---
                    subgraph AR_Flow ["INFLOW: Accounts Receivable"]
                        SHIP_TRIG(("Shipment Confirmed")) --> GEN_INV["Generate Invoice"]
                        GEN_INV --> SEND_INV["Email to Customer"]
                        SEND_INV --> AGE_CHK{"Payment Due?"}
                        
                        AGE_CHK -- "No" --> WAIT["Wait Terms"]
                        AGE_CHK -- "Yes" --> PAID_CHK{"Received?"}
                        
                        PAID_CHK -- "Yes" --> POST_CASH["Post Cash Receipt"]
                        POST_CASH --> CLEAR_AR["Clear Open Item"]
                        
                        PAID_CHK -- "No" --> COLLECTIONS["Start Collections"]
                        COLLECTIONS --> HOLD_TRIG[["Place Credit Hold"]]
                    end

                    %% CONNECTIONS
                    HOLD_TRIG -.->|Stop Sales| SALES_LINK[["Sales Module"]]

                    %% Styles
                    class SHIP_TRIG,GEN_INV,SEND_INV,AGE_CHK,WAIT,PAID_CHK,POST_CASH,CLEAR_AR,COLLECTIONS,HOLD_TRIG finance;
                    class SALES_LINK commercial;
                </div>
            </div>

            <!-- RIGHT COLUMN: AP -->
            <div class="diagram-card">
                <h3>Part 2: Accounts Payable (Outflow)</h3>

                <div class="mermaid">
                graph TD
                    %% Define Colors
                    classDef finance fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px;
                    classDef treasury fill:#fff9c4,stroke:#fbc02d,stroke-width:2px;

                    %% --- ACCOUNTS PAYABLE ---
                    subgraph AP_Flow ["OUTFLOW: Accounts Payable"]
                        VEND_INV(("Vendor Inv Rec'd")) --> MATCH_3{"3-Way Match?"}
                        
                        MATCH_3 -- "Match OK" --> POST_AP["Post Liability"]
                        POST_AP --> DUE_CHK{"Due Date?"}
                        
                        DUE_CHK -- "Yes" --> CASH_CHK{"Cash Available?"}
                        
                        %% --- TREASURY LOOP ---
                        subgraph Treasury ["Treasury / Funding"]
                            CASH_CHK -- "No" --> FIN_OPT{"Source?"}
                            FIN_OPT -- "Channel Fin" --> REQ_CF["Request Drawdown"]
                            FIN_OPT -- "Credit Line" --> REQ_OD["Use Overdraft"]
                            REQ_CF --> FUND_RX["Funds Received"]
                            REQ_OD --> FUND_RX
                        end

                        FUND_RX --> PAY_RUN["Exec Payment Run"]
                        CASH_CHK -- "Yes" --> PAY_RUN
                        
                        PAY_RUN --> BANK_FILE["Send Bank File"]
                        BANK_FILE --> REMIT["Send Remittance"]
                        
                        MATCH_3 -- "Mismatch" --> DISPUTE["Hold & Dispute"]
                    end

                    %% Styles
                    class VEND_INV,MATCH_3,POST_AP,DUE_CHK,CASH_CHK,PAY_RUN,BANK_FILE,REMIT,DISPUTE finance;
                    class FIN_OPT,REQ_CF,REQ_OD,FUND_RX treasury;
                </div>
            </div>
        </div>

        <!-- AI OPPORTUNITY SECTION -->
        <div class="ai-card" style="border-left-color: #27ae60;">
            <h3>ü§ñ AI Opportunities: Finance <span class="tag" style="background-color: #27ae60;">Control</span></h3>
            
            <div class="comparison-grid">
                <!-- Idea 1 -->
                <div class="col">
                    <h4>1. Autonomous 3-Way Match</h4>
                    <p class="shadow-work"><b>Shadow Work:</b> Staring at screens to match PO vs Invoice line-by-line.</p>
                    <p class="ai-sol"><b>AI Solution:</b> Auto-approves matches within tolerance (<$0.05). Humans only handle exceptions.</p>
                    <p class="human-role"><b>Human:</b> Exception Auditor.</p>
                </div>
                <!-- Idea 2 -->
                <div class="col">
                    <h4>2. Cash Flow Oracle</h4>
                    <p class="shadow-work"><b>Shadow Work:</b> Reacting to "We have no money" surprises.</p>
                    <p class="ai-sol"><b>AI Solution:</b> Predicts cash crunch 2 weeks out based on real AP/AR dates, not assumptions.</p>
                    <p class="human-role"><b>Human:</b> Treasurer.</p>
                </div>
                <!-- Idea 3 -->
                <div class="col">
                    <h4>3. Fraud Sentinel</h4>
                    <p class="shadow-work"><b>Shadow Work:</b> Manual spot checks for fake invoices.</p>
                    <p class="ai-sol"><b>AI Solution:</b> Flags anomalies like "Vendor changed bank details" or "Invoice # out of sequence."</p>
                    <p class="human-role"><b>Human:</b> Controller.</p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
